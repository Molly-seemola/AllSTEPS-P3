<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="View your shopping cart and complete your purchase at AllStepz. Secure payment for branded shoes." />
  <meta name="keywords" content="shopping cart, checkout, buy shoes online, AllStepz" />
  <title>AllStepz | Shopping Cart</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <header>
    <h1>AllStepz</h1>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="products.html">Products</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="enquiry.html">Enquiry</a></li>
        <li><a href="contact.html">Contact</a></li>
        <li><a href="cart.html" class="active">Cart ðŸ›’ <span id="cart-count">0</span></a></li>
      </ul>
    </nav>
  </header>

  <div class="container page-container">
    <h2>Your Shopping Cart</h2>
    
    <div id="cart-items"></div>
    <h3 id="total-price"></h3>

    <div id="payment-section" style="display:none;">
      <h2>Payment Details</h2>
      <form id="payment-form" class="contact-form">
        <div class="form-group">
          <label for="fullName">Full Name *</label>
          <input type="text" id="fullName" required placeholder="Enter your full name">
        </div>

        <div class="form-group">
          <label for="cardNumber">Card Number *</label>
          <input type="text" id="cardNumber" maxlength="16" required placeholder="1234 5678 9012 3456">
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="expiry">Expiry Date (MM/YY) *</label>
            <input type="text" id="expiry" maxlength="5" placeholder="MM/YY" required>
          </div>

          <div class="form-group">
            <label for="cvv">CVV *</label>
            <input type="text" id="cvv" maxlength="3" required placeholder="123">
          </div>
        </div>

        <div class="form-group">
          <label for="address">Shipping Address *</label>
          <textarea id="address" rows="3" required placeholder="Enter your full delivery address"></textarea>
        </div>

        <button type="submit" class="btn">Complete Payment</button>
      </form>
    </div>
  </div>

  <footer>
    <p>&copy; <span id="footer-year">2025</span> AllStepz | Affordable Branded Shoes</p>
    <p>Last updated: <span id="last-updated"></span></p>
    <div class="social-icons">
      <a href="#" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
      <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
      <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
    </div>
  </footer>

  <script>
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    
    // Update cart count
    function updateCartCount() {
      document.getElementById('cart-count').textContent = cart.length;
    }
    
    // Render cart items
    function renderCart() {
      const cartContainer = document.getElementById('cart-items');
      const totalPriceElement = document.getElementById('total-price');
      const paymentSection = document.getElementById('payment-section');
      
      cartContainer.innerHTML = '';
      let total = 0;
      
      if (cart.length === 0) {
        cartContainer.innerHTML = `
          <div class="empty-cart">
            <i class="fas fa-shopping-cart" style="font-size: 3rem; color: #ccc;"></i>
            <p>Your cart is empty.</p>
            <a href="products.html" class="btn">Continue Shopping</a>
          </div>
        `;
        totalPriceElement.textContent = '';
        paymentSection.style.display = 'none';
        return;
      }
      
      cart.forEach((item, index) => {
        total += item.price;
        const cartItem = document.createElement('div');
        cartItem.className = 'cart-item';
        cartItem.innerHTML = `
          <div class="cart-item-info">
            <h4>${item.name}</h4>
            <p>Size: ${item.size}</p>
            <p class="price">R${item.price.toFixed(2)}</p>
          </div>
          <button class="remove-btn" data-index="${index}">
            <i class="fas fa-trash"></i> Remove
          </button>
        `;
        cartContainer.appendChild(cartItem);
      });
      
      totalPriceElement.innerHTML = `<strong>Total: R${total.toFixed(2)}</strong>`;
      paymentSection.style.display = 'block';
      attachRemoveEvents();
    }
    
    // Attach remove button events
    function attachRemoveEvents() {
      const removeButtons = document.querySelectorAll('.remove-btn');
      removeButtons.forEach(btn => {
        btn.addEventListener('click', function() {
          const index = parseInt(this.getAttribute('data-index'));
          const itemName = cart[index].name;
          
          if (confirm(`Remove ${itemName} from cart?`)) {
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            renderCart();
          }
        });
      });
    }
    
    // Show popup notification
    function showPopup(type, title, message) {
      let popupOverlay = document.getElementById('popupOverlay');
      
      if (!popupOverlay) {
        popupOverlay = document.createElement('div');
        popupOverlay.id = 'popupOverlay';
        popupOverlay.className = 'popup-overlay';
        document.body.appendChild(popupOverlay);
      }
      
      popupOverlay.innerHTML = `
        <div class="popup-content">
          <div class="popup-icon ${type}">
            <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
          </div>
          <h3 class="popup-title">${title}</h3>
          <p class="popup-message">${message}</p>
          <button class="popup-button" onclick="closePopup()">OK</button>
        </div>
      `;
      
      setTimeout(() => {
        popupOverlay.classList.add('active');
      }, 10);
    }
    
    window.closePopup = function() {
      const popupOverlay = document.getElementById('popupOverlay');
      if (popupOverlay) {
        popupOverlay.classList.remove('active');
        setTimeout(() => {
          if (popupOverlay.parentNode) {
            popupOverlay.parentNode.removeChild(popupOverlay);
          }
        }, 300);
      }
    };
    
    // Payment form validation
    const paymentForm = document.getElementById('payment-form');
    
    paymentForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const fullName = document.getElementById('fullName').value.trim();
      const cardNumber = document.getElementById('cardNumber').value.trim();
      const expiry = document.getElementById('expiry').value.trim();
      const cvv = document.getElementById('cvv').value.trim();
      const address = document.getElementById('address').value.trim();
      
      // Validation
      if (!fullName || fullName.length < 2) {
        showPopup('error', 'Invalid Name', 'Please enter your full name.');
        return;
      }
      
      if (cardNumber.length !== 16 || isNaN(cardNumber)) {
        showPopup('error', 'Invalid Card Number', 'Card number must be exactly 16 digits.');
        return;
      }
      
      if (!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expiry)) {
        showPopup('error', 'Invalid Expiry Date', 'Please use MM/YY format (e.g., 12/25).');
        return;
      }
      
      if (cvv.length !== 3 || isNaN(cvv)) {
        showPopup('error', 'Invalid CVV', 'CVV must be exactly 3 digits.');
        return;
      }
      
      if (!address || address.length < 10) {
        showPopup('error', 'Invalid Address', 'Please provide a complete delivery address.');
        return;
      }
      
      // Show loading state
      const submitBtn = paymentForm.querySelector('button[type="submit"]');
      submitBtn.classList.add('loading');
      submitBtn.disabled = true;
      
      // Simulate payment processing
      setTimeout(() => {
        submitBtn.classList.remove('loading');
        submitBtn.disabled = false;
        
        const total = cart.reduce((sum, item) => sum + item.price, 0);
        const now = new Date();
        const dateTime = now.toLocaleString('en-ZA', {
          year: 'numeric',
          month: 'long',
          day: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        });
        
        showPopup('success', 'Payment Successful!', 
          `Thank you for your purchase of R${total.toFixed(2)}! Your order was processed on ${dateTime}. Order confirmation sent to your email. You will be redirected shortly.`);
        
        // Clear cart and redirect after popup closes
        setTimeout(() => {
          localStorage.removeItem('cart');
          cart = [];
          window.location.href = 'products.html';
        }, 3500);
      }, 2000);
    });
    
    // Format card number input
    document.getElementById('cardNumber').addEventListener('input', function(e) {
      this.value = this.value.replace(/\D/g, '');
    });
    
    // Format CVV input
    document.getElementById('cvv').addEventListener('input', function(e) {
      this.value = this.value.replace(/\D/g, '');
    });
    
    // Format expiry date
    document.getElementById('expiry').addEventListener('input', function(e) {
      let value = this.value.replace(/\D/g, '');
      if (value.length >= 2) {
        value = value.slice(0, 2) + '/' + value.slice(2, 4);
      }
      this.value = value;
    });
    
    // Update footer date and time
    function updateDateTime() {
      const now = new Date();
      const year = now.getFullYear();
      const options = { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric', 
        hour: '2-digit', 
        minute: '2-digit' 
      };
      const formattedDate = now.toLocaleDateString('en-ZA', options);
      
      document.getElementById('footer-year').textContent = year;
      document.getElementById('last-updated').textContent = formattedDate;
    }
    
    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      updateCartCount();
      renderCart();
      updateDateTime();
    });
  </script>
</body>
</html>